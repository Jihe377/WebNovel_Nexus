<!DOCTYPE html>
<html lang="en" data-bs-theme="light">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Novel Detail | WebNovel Nexus</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"/>
  <link href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@24,400,0,0" rel="stylesheet"/>
  <link rel="stylesheet" href="./css/novel.css"/>
</head>
<body>

<!-- NAVBAR -->
<nav class="navbar navbar-expand-md sticky-top border-bottom shadow-sm bg-body">
  <div class="container-xl">
    <a class="navbar-brand fw-bold d-flex align-items-center gap-2" href="homepage.html">
      <span class="bg-primary text-white rounded-2 p-1 d-inline-flex align-items-center">
        <span class="material-symbols-outlined" style="font-size:20px">book_4</span>
      </span>
      WebNovel Nexus
    </a>
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#mainNav">
      <span class="navbar-toggler-icon"></span>
    </button>
    <div class="collapse navbar-collapse" id="mainNav">
      <ul class="navbar-nav me-auto gap-md-1 mb-2 mb-md-0">
        <li class="nav-item"><a class="nav-link" href="index.html"><span class="material-symbols-outlined align-middle" style="font-size:16px">explore</span> Discover</a></li>
        <li class="nav-item"><a class="nav-link" href="add.html"><span class="material-symbols-outlined align-middle" style="font-size:16px">add_circle</span> Add Novel</a></li>
        <li class="nav-item"><a class="nav-link" href="booklist.html"><span class="material-symbols-outlined align-middle" style="font-size:16px">bookmarks</span> Booklist</a></li>
      </ul>
      <div class="d-flex gap-2 align-items-center mt-2 mt-md-0">
        <button class="btn btn-sm btn-outline-secondary" id="themeToggle" title="Toggle theme">
          <span class="material-symbols-outlined align-middle" style="font-size:18px" id="themeIcon">dark_mode</span>
        </button>
      </div>
    </div>
  </div>
</nav>

<!-- BREADCRUMB -->
<div class="bg-body-tertiary border-bottom py-2">
  <div class="container-xl">
    <nav aria-label="breadcrumb">
      <ol class="breadcrumb mb-0 small">
        <li class="breadcrumb-item"><a href="homepage.html" class="text-decoration-none">Home</a></li>
        <li class="breadcrumb-item active" id="breadcrumbTitle">Novel</li>
      </ol>
    </nav>
  </div>
</div>

<!-- MAIN -->
<main class="container-xl py-4">

  <div class="text-center py-5" id="loadingState">
    <div class="spinner-border text-primary" role="status"></div>
    <p class="mt-3 text-muted">Loading novel…</p>
  </div>

  <div class="text-center py-5 d-none" id="errorState">
    <span class="material-symbols-outlined d-block mb-2 text-muted" style="font-size:48px">error</span>
    <h5 class="fw-bold">Novel not found</h5>
    <p class="text-muted">The novel you're looking for doesn't exist or failed to load.</p>
    <a href="index.html" class="btn btn-primary btn-sm">Back to Discover</a>
  </div>

  <div class="d-none" id="content">
    <div class="row g-4">

      <!-- LEFT -->
      <div class="col-lg-8">
        <div class="card shadow-sm mb-4">
          <div class="card-body p-4">
            <div class="d-flex gap-4 flex-wrap flex-sm-nowrap">
              <div class="cover-placeholder">
                <span class="material-symbols-outlined text-white" style="font-size:48px">auto_stories</span>
              </div>
              <div class="flex-grow-1">
                <div class="d-flex align-items-center gap-2 flex-wrap mb-1">
                  <h2 class="fw-bold mb-0" id="novelName">—</h2>
                  <span id="novelStatus" class="badge"></span>
                </div>
                <p class="text-muted mb-2">
                  <span class="material-symbols-outlined align-middle me-1" style="font-size:16px">person</span>
                  <span id="novelAuthor">—</span>
                </p>

                <div class="d-flex flex-wrap gap-3 mb-3 small text-muted">
                  <span>
                    <span class="material-symbols-outlined align-middle" style="font-size:14px">visibility</span>
                    <span id="novelReads">0</span> reads
                  </span>
                  <span>
                    <span class="material-symbols-outlined align-middle" style="font-size:14px">star</span>
                    <span id="novelRating">—</span>
                  </span>
                  <span>
                    <span class="material-symbols-outlined align-middle" style="font-size:14px">calendar_today</span>
                    <span id="novelDate">—</span>
                  </span>
                </div>

                <!-- Genre + Tags -->
                <div class="d-flex flex-wrap gap-1 align-items-center" id="genreTagsRow"></div>

                <div class="d-flex gap-2 flex-wrap mt-3">
                  <button class="btn btn-primary btn-sm d-flex align-items-center gap-1">
                    <span class="material-symbols-outlined" style="font-size:16px">menu_book</span>
                    Start Reading
                  </button>
                </div>
              </div>
            </div>

            <hr class="mt-4 mb-3"/>
            <h6 class="fw-bold mb-2">
              <span class="material-symbols-outlined align-middle me-1 text-primary" style="font-size:16px">description</span>
              Description
            </h6>
            <p class="text-muted mb-0" id="novelDesc" style="line-height:1.7">—</p>
          </div>
        </div>

        <!-- Reviews -->
        <div class="card shadow-sm">
          <div class="card-header py-3 d-flex align-items-center justify-content-between">
            <span class="fw-bold">
              <span class="material-symbols-outlined align-middle text-primary me-1" style="font-size:18px">reviews</span>
              Reviews
              <span class="badge bg-secondary ms-1" id="reviewCount">0</span>
            </span>
            <button class="btn btn-primary btn-sm d-flex align-items-center gap-1"
                    data-bs-toggle="collapse" data-bs-target="#writeReview">
              <span class="material-symbols-outlined" style="font-size:15px">edit</span>
              Write a Review
            </button>
          </div>

          <div class="collapse" id="writeReview">
            <div class="card-body border-bottom bg-body-tertiary">
              <h6 class="fw-semibold mb-3">Your Review</h6>
              <div class="mb-3">
                <label class="form-label small fw-semibold">Rating</label>
                <div class="d-flex gap-1" id="starPicker">
                  <span class="material-symbols-outlined star-pick text-muted" style="font-size:28px;cursor:pointer" data-v="1">star</span>
                  <span class="material-symbols-outlined star-pick text-muted" style="font-size:28px;cursor:pointer" data-v="2">star</span>
                  <span class="material-symbols-outlined star-pick text-muted" style="font-size:28px;cursor:pointer" data-v="3">star</span>
                  <span class="material-symbols-outlined star-pick text-muted" style="font-size:28px;cursor:pointer" data-v="4">star</span>
                  <span class="material-symbols-outlined star-pick text-muted" style="font-size:28px;cursor:pointer" data-v="5">star</span>
                </div>
                <input type="hidden" id="selectedRating" value="0"/>
              </div>
              <div class="mb-3">
                <label class="form-label small fw-semibold">Username</label>
                <input type="text" class="form-control form-control-sm" id="reviewUser" placeholder="Your name"/>
              </div>
              <div class="mb-3">
                <label class="form-label small fw-semibold">Comment</label>
                <textarea class="form-control form-control-sm" id="reviewBody" rows="3" placeholder="Share your thoughts…"></textarea>
              </div>
              <button class="btn btn-primary btn-sm" onclick="submitReview()">Submit Review</button>
              <div class="mt-2 small text-danger d-none" id="reviewError">Please fill in all fields and select a rating.</div>
            </div>
          </div>

          <div class="card-body p-3" id="reviewsList">
            <div class="text-center py-4 text-muted">
              <div class="spinner-border spinner-border-sm text-primary"></div>
              <span class="ms-2 small">Loading reviews…</span>
            </div>
          </div>
        </div>
      </div>

      <!-- RIGHT: Recommendations -->
      <div class="col-lg-4">
        <div class="card shadow-sm sticky-top" style="top: 76px;">
          <div class="card-header py-3">
            <span class="fw-bold">
              <span class="material-symbols-outlined align-middle text-primary me-1" style="font-size:18px">recommend</span>
              Recommended For You
            </span>
          </div>
          <div class="card-body p-2" id="recList">
            <div class="text-center py-4 text-muted small">
              <div class="spinner-border spinner-border-sm text-primary"></div>
              <p class="mt-2 mb-0">Loading recommendations…</p>
            </div>
          </div>
        </div>
      </div>

    </div>
  </div>
</main>

<!-- FOOTER -->
<footer class="border-top bg-body-tertiary mt-5 py-4">
  <div class="container-xl text-center">
    <div class="d-flex justify-content-center align-items-center gap-2 mb-2">
      <span class="bg-primary bg-opacity-25 text-primary rounded p-1 d-inline-flex">
        <span class="material-symbols-outlined" style="font-size:18px">book_4</span>
      </span>
      <span class="fw-bold">WebNovel Nexus</span>
    </div>
    <p class="text-muted small mb-3">Explore thousands of worlds, one chapter at a time.</p>
    <p class="text-muted" style="font-size:.75rem">Created by Danyan Gu and Xing Zhou</p>
  </div>
</footer>

<div class="toast-container position-fixed bottom-0 end-0 p-3" id="toastContainer"></div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="./js/novel.js"></script>

</body>
</html>